<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transit — demo</title>
    <style>
      :root{--accent:#d4001f;--dark:#0b1220;--muted:#6b7280;--card:#ffffff}
      html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,'Helvetica Neue',Arial}
      body{background:linear-gradient(180deg,#f6f7fb 0%, #fff 100%);color:var(--dark)}
      .topbar{display:flex;align-items:center;justify-content:space-between;padding:18px 28px;background:linear-gradient(90deg,rgba(255,255,255,0.7),rgba(255,255,255,0.6));backdrop-filter:blur(6px);position:sticky;top:0;z-index:40;border-bottom:1px solid rgba(11,18,32,0.04)}
      .brand{display:flex;align-items:center;gap:12px}
      .logo{width:44px;height:44px;border-radius:8px;background:var(--accent);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
      nav a{margin-left:18px;color:var(--muted);text-decoration:none;font-weight:600}
      .hero{display:grid;grid-template-columns:1fr 480px;gap:32px;align-items:center;padding:56px 6vw}
      .hero-left h1{font-size:36px;margin:0 0 12px}
      .hero-left p{margin:0 0 20px;color:var(--muted);max-width:52ch}
      .search-card{background:linear-gradient(180deg,#fff,#fbfbfd);box-shadow:0 6px 18px rgba(11,18,32,0.06);padding:18px;border-radius:12px;border:1px solid rgba(11,18,32,0.04)}
      .fields{display:grid;grid-template-columns:1fr 1fr;gap:8px}
      .field{display:flex;flex-direction:column}
      label{font-size:12px;color:var(--muted);margin-bottom:6px}
      input,select{padding:10px 12px;border:1px solid #e6e9ef;border-radius:8px;font-size:14px}
      .actions{display:flex;gap:10px;margin-top:12px}
      .btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
      .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(212,0,31,0.12)}
      .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;padding:32px 6vw}
      .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 16px rgba(11,18,32,0.04);border:1px solid rgba(11,18,32,0.04)}
      .card h3{margin:0 0 8px}
      .footer{padding:28px 6vw;border-top:1px solid rgba(11,18,32,0.04);color:var(--muted);display:flex;justify-content:space-between;align-items:center}
      @media(max-width:900px){.hero{grid-template-columns:1fr;gap:18px;padding:28px} .cards{grid-template-columns:1fr} nav a{display:none}}
    </style>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="logo">T</div>
      </div>
      <nav style="display: flex !important; flex-direction: column; background-color: #f0f0f0; z-index: 9999; position: relative;">
        <a href="index3.html" style="padding: 20px; display: block; color: blue;">Formulario</a>
        <a href="help.html" style="padding: 10px; display: block;">Help</a>
        <a href="index2.html" style="padding: 10px; display: block;">Gráficas de quejas</a>
        <a href="respuestas.html" style="padding: 10px; display: block;">Gráficas de quejas del formulario</a>
      </nav>
    </header>

    <main>
      <section class="hero">
        <div class="hero-left">
          <h1>Planeación rápida y simple</h1>
          <p>Busca conexiones, compara opciones y reserva tu viaje. Esta demo muestra una experiencia limpia inspirada en sitios modernos.</p>
          <div style="display:flex;gap:12px;margin-top:20px">
            <button class="btn">Reservar Viaje</button>
            <button class="btn ghost">Ver Horarios</button>
          </div>
        </div>
      </section>

      <section class="cards">
        <div class="card">
          <h3>Conexiones rápidas</h3>
          <p style="color:var(--muted)">Encuentra rutas directas entre ciudades principales.</p>
        </div>
        <div class="card">
          <h3>Tickets flexibles</h3>
          <p style="color:var(--muted)">Compara opciones de reembolso y cambios.</p>
        </div>
        <div class="card">
          <h3>Alertas de viaje</h3>
          <p style="color:var(--muted)">Actualizaciones en tiempo real sobre disrupciones.</p>
        </div>
      </section>
      
      <section id="top30" style="padding:24px 6vw">
        <h2 style="margin:0 0 12px">Top 30 palabras del contenido de las quejas</h2>
        <p style="margin:0 0 16px;color:var(--muted)">Palabras más frecuentes extraídas del dataset.</p>
        <div class="card" style="padding:12px">
          <div id="tableContainer">Cargando datos...</div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div>© Transit Demo — No afiliado con ningún operador</div>
      <div style="font-size:13px;color:var(--muted)">Built for the hackathon — local demo only</div>
    </footer>

    <script>
      // Función auto-ejecutable para cargar la tabla
      (function renderTop30(){
        const container = document.getElementById('tableContainer');
        // Asegúrate de que la carpeta 'tablas' y el archivo existan junto a este HTML
        const src = 'tablas/top30.json';

        function human(n){ return n.toLocaleString(); }
        function escapeHtml(s){ return (s+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

        function buildTable(data){
          if(!data || !data.length){ 
            container.innerHTML = '<div style="color:var(--muted)">No hay datos disponibles</div>'; 
            return; 
          }

          // Calcular máximo para las barras de progreso
          const max = Math.max(...data.map(d => d.count));
          
          const table = document.createElement('table');
          table.style.width = '100%';
          table.style.borderCollapse = 'collapse';
          
          // AQUI ESTABA EL ERROR: Usamos comillas invertidas ` ` para el HTML
          table.innerHTML = `
            <thead>
              <tr style="text-align:left;color:var(--muted); border-bottom: 1px solid #eee;">
                <th style="width:64px;padding:10px;cursor:pointer">#</th>
                <th style="padding:10px;cursor:pointer">Palabra</th>
                <th style="width:160px;padding:10px;cursor:pointer">Frecuencia</th>
              </tr>
            </thead>
            <tbody></tbody>
          `;
          
          const tbody = table.querySelector('tbody');
          
          data.forEach((row, i) => {
            const tr = document.createElement('tr');
            tr.style.transition = 'background 120ms';
            tr.style.borderBottom = '1px solid #f9f9f9';
            
            tr.onmouseenter = () => tr.style.background = 'linear-gradient(90deg, rgba(212,0,31,0.04), rgba(11,18,32,0.02))';
            tr.onmouseleave = () => tr.style.background = 'transparent';
            
            // Calculamos porcentaje para la barra
            const pct = Math.round((row.count / max) * 100);
            const colorRank = i < 3 ? 'var(--accent)' : 'var(--dark)';

            // Creamos el HTML interno de la fila usando Template Strings (``)
            tr.innerHTML = `
                <td style="padding:10px;">
                    <div style="font-weight:800; color:${colorRank}">${i+1}</div>
                </td>
                <td style="padding:10px;">
                    <div style="font-weight:700; font-size:15px">${escapeHtml(row.word)}</div>
                </td>
                <td style="padding:10px;">
                    <div style="display:flex; align-items:center; gap:8px">
                        <div style="flex:1; background:#f1f5f9; border-radius:999px; overflow:hidden; height:6px; min-width: 50px;">
                            <div style="width:${pct}%; height:100%; background:linear-gradient(90deg,var(--accent),#ff6b6b)"></div>
                        </div>
                        <div style="min-width:40px; text-align:right; font-weight:700; font-size:13px;">${human(row.count)}</div>
                    </div>
                </td>
            `;
            tbody.appendChild(tr);
          });

          container.innerHTML = '';
          container.appendChild(table);
        }

        // Fetch de datos
        fetch(src)
            .then(r => {
                if (!r.ok) throw new Error("No se encontró el archivo: " + src);
                return r.json();
            })
            .then(data => {
                // Asegurar orden descendente
                data.sort((a,b) => b.count - a.count);
                buildTable(data);
            })
            .catch(err => {
                container.innerHTML = `<div style="color:#d4001f; padding: 20px;">
                    <strong>Error al cargar datos:</strong><br> 
                    ${escapeHtml(err.message)}<br><br>
                    <small>Verifica que exista la carpeta 'tablas' y el archivo 'top30.json'.</small>
                </div>`;
                console.error(err);
            });
      })();
    </script>
  </body>
</html>